{$_title = "Меню приложений"}
{$wa->title($_title)}

<div class="u-component-page">

    <h1>Меню <code>{literal}{$wa->header()}{/literal}</code></h1>

    <p class="large">Фирменный знак Webasyst — верхнее меню навигации с иконками приложений — сохранился и был серьезно улучшен. Появились новые режимы <code>'custom'</code> (свое наполнение меню) и <code>single_app_mode</code> (без меню).</p>

    <h3>Всегда наверху: <code>top: 0; height: 4rem;</code></h3>
    <p>Особенность <code>$wa->header()</code> в Webasyst 2 — он всегда находится на самом верху экрана (<code>position: fixed; <strong>top: 0;</strong> left: 0; right: 0;</code>) и имеет высоту = <code>height: <strong>4rem</strong></code>.</p>
    <p>Выше <code>$wa->header()</code> в Webasyst 2, в отличие от Webasyst 1.x, не может быть ничего. Ниже и даже поверх — без проблем. Но не выше. Такое ограничение и жесткость геометрии <code>$wa->header()</code> введены по двум основным причинам. Во-первых, для целостности восприятия интерфейса пользователем. Логотип аккаунта показывается всегда в верхнем левом углу экрана и никак иначе (как кнопка Esc на клавиатуре). Во-вторых, для предсказуемости поведения внешней обвязки для разработчиков сторонних приложений. Разработчик гипотетического «Супер-пупер-сервиса» для Webasyst должен быть уверен, что никакие баннеры, анонсы или уведомления с рекламой Shop-Script или Pocket Lists не будут показаны в интерфейсе его приложения.</p>

    <p>Все агитационные баннеры и призывы можно размещать либо в виде анонса (<code>wa_announcement</code>) в дашборде и «под колокольчиком» или же с индивидуальным дизайном в интерфейсе своего приложения ниже <code>$wa->header()</code> с использованием CSS-класса <a href="{$wa_app_url}component/banner/">.banner</a>.</p>

    <h3><code>#wa</code> &gt; <code>#wa-header</code> + <code>#wa-app</code></h3>

    <p>Типовая структура шаблона приложения в wa-2.0 практически не изменилась по сравнению с wa-1.3 и по-прежнему основана на <code>#wa</code>, <code>#wa-header</code> и <code>#wa-app</code>. Так же, как и в wa-1.3, <em>приложение самостоятельно рисует</em> полную страницу от <code>&lt;html&gt;</code> до <code>&lt;/html&gt;</code> и, следовательно, в своих шаблонах вызывает хелпер отрисовки меню навигации приложения — <code>&#123;$wa->header()&#125;</code>.</p>

    <p>Единственное важное отличие — теперь <code>#wa-header</code> имеет более общую обертку <code>#wa-nav</code> в связи с расширением возможностей навигации в бекенде.</p>

    <pre class="prettyprint">
&lt;body&gt;
    &lt;div id="<b>wa</b>"&gt;

        <b>&#123;$wa->header()&#125;</b>

        &lt;div id="<b>wa-app</b>"&gt;

            &lt;!-- YOUR APP HERE --&gt;
            &lt;div class="flexbox"&gt;
                &lt;div class="sidebar"&gt;
                    <em>app navigation</em>
                &lt;/div&gt;
                &lt;div class="content"&gt;
                    <em>app content</em>
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;!-- /YOUR APP HERE --&gt;

        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;</pre>

    <h3>{literal}{$wa->header( <code>[ 'custom' => [ ... ] ]</code> )}{/literal}</h3>

    <p>В некоторых особых случаях, когда разработчику приложения нужно «приглушить» базовую возможность Вебасиста работать с разными приложениями, разработчик может <em>в рамках своего приложения</em> использовать вариант навигации, скрывающий иконки других приложений в <code>$wa->header()</code>, получив тем самым дополнительное пространство для реализации навигации внутри приложения. Для этого достаточно передать в вызов {literal}<code>{$wa->header( [ 'custom' => <b>[ 'main' => '...', 'user' => '...' ]</b> ] )}</code>{/literal}:</p>

    <ul class="separated">
        <li><code>'main'</code>: если переданное в этом элементе HTML-содержимое непустое, то оно будет выведено <em>вместо</em> горизонтального меню приложений (#wa-applist). Меню приложений останется доступным только в развернутом состоянии меню по клику на иконку справа.</li>
        <li><code>'aux'</code>: содержимое этого элемента (тоже HTML) будет выведено в правом блоке меню слева от кнопки перехода в развернутое состояние верхнего меню.</li>
    </ul>

    <p>Пример:</p>

<pre class="prettyprint">
&#123;$wa->header([
    'custom' => [
        'main' => 'your custom app navigation',
        'aux' => '&lt;input class="button brown smaller" type="button" value="[`Upgrade`]" /&gt;'
    ]
])&#125;</pre>

    <p>С помощью <code>['aux']</code> удобно добавлять в верхнюю навигацию отдельные «небольшие» интерфейсные элементы, например, переключатель вида или кнопку некоторого важного для приложения действия (например, Upgrade).</p>

    <p>Использование <code>['main']</code> рекомендуется только в особых случаях, когда внимание пользователей следует сосредоточить на данном единственном приложении вместо удобной работы сразу с несколькими. Например, когда это брендированный сервис Х, состоящий из единственного приложения, а все сопутствующие приложения («Команда», «Сайт», «Настройки» и т. д.) являются неактуальными или даже отсутствуют. Как заполнить это свободное пространство и как организовать взаимосвязь с любыми системными приложениями Webasyst, включая «Настройки», «Инсталлер», «Сайт», «Команду» (например, управление правами доступа) — в 'custom'-режиме <code>$wa->header()</code> остается исключительно на усмотрение разработчика приложения.</p>

    <h5>Замена $wa->header() на лету (JS)</h5>

    <p>Во многих случаях будет полезно менять содержимое <code>$wa->header()</code> в зависимости от контекста внутри приложения и скрывать или, наоборот, показывать меню приложений только тогда, когда это действительно полезно для пользователя.</p>
    <p>В качестве примера замены на лету смотрите приложение «Фото» и поведение меню при переходе из списка фото на страницу отдельной фотографии.</p>

    <hr>

    <h3>Полный отказ от $wa->header()</h3>
    <p>У разработчика есть техническая возможность полного отказа от использования <code>$wa->header()</code> в своем приложении — для этого достаточно просто не включать вызов <code>$wa->header()</code> в своем приложении.</p>
    <p>Такое поведение легально и действительно может быть полезно при разработке собственных независимых AaaS-сервисов (App as a Service) на основе фреймворка Webasyst, в которых есть единственное приложение и ничего более — ни дашборда, ни системных приложений, ни брендинга и упоминаний Webasyst.</p>
    <p>Требование наличия <code>$wa->header()</code> в приложении действует только в случае распространения приложения в рамках экосистемы Webasyst и «Инсталлера» (<a href="https://developers.webasyst.ru/docs/store/webasyst-store-requirements/">пункт №18</a>). В этом случае обязательно использование либо базового вида <code>$wa->header()</code>, либо собственного варианта — <code>$wa->header( [ 'custom' => [ ... ] ])</code>. Наличие <code>$wa->header()</code> в этом случае необходимо для обеспечения связности приложения с другими установленными приложениями и целостного опыта работы пользователя с Webasyst как с платформой, обеспечивающей функциональное единство разных приложений.</p>

    <h5><code>&#123;$wa->isSingleAppMode()&#125;</code></h5>

    <p>Начиная с версии Webasyst 3.0 фреймворк может работать <a href="https://developers.webasyst.ru/docs/cookbook/single-app-mode/">в ограниченном режиме «одного приложения»</a> <code>'single_app_mode' => true</code>, в котором отображение верхнего меню отключается на системном уровне. Режим регулируется администратором аккаунта Webasyst и в ряде случаев — тарифным планом в облаке Webasyst.</p>
    <p>Определить внутри Smarty-шаблона приложения, включен ли в данный момент режим работы одного приложения или нет, возможно с помощью хелпера <code>&#123;$wa->isSingleAppMode()&#125;</code>.</p>

    <script>
        $.wa_ui.title.set({$_title|json_encode});

        if (typeof prettyPrint != 'undefined' && $.isFunction(prettyPrint)) {
            prettyPrint();
        }
    </script>
</div>
