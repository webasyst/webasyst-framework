<!-- Site app page list -->
{$pages = $wa->site->pages()}

{if count($pages)}
    <ul class="pages">
    
        {* get selected node (a little magic here): for Site app, due to it's page-only functionality, page heirarchy and ambiguous select highlighe conditions for root app URL we get selected node in 2 foreach's, while for other apps single foreach for pages is ok due to their own content for homepage *}
        {$selected_node = null}
        {foreach $pages as $p}
            {if $wa->currentUrl()|strstr:$p.url && strlen($p.url) >= strlen($selected_node.url)}{$selected_node = $p}{/if}
        {/foreach}
        {if !$selected_node}{$selected_node.id = null}{/if}
        
        {* render *}
        {foreach $pages as $p}
            {if $p.url != $wa_url} {* exclude root page link to avoid duplicate link which is on the logo/title *}
                <li{if $p.id == $selected_node.id} class="selected"{/if}><a href="{$p.url}">{$p.name}</a></li>
            {/if}
        {/foreach}
        {* PLUGINS @ frontend_nav *}
            {foreach $frontend_nav as $_key => $_}
                <li>
                    <a href="javascript:void(0);" onClick="return false">
                        {if substr($_key, -7) == '-plugin'}{$wa->pluginName(substr($_key, 0, -7))}{else}[`More`]{/if}
                    </a>
                    <div class="flyout">
                        <div class="container">
                            {$_}
                        </div>
                    </div>
                </li>
            {/foreach}
            {foreach $frontend_nav_aux as $_key => $_}
                <li>
                    <a href="javascript:void(0);" onClick="return false">
                        {if substr($_key, -7) == '-plugin'}{$wa->pluginName(substr($_key, 0, -7))}{else}[`More`]{/if}
                    </a>
                    <div class="flyout">
                        <div class="container">
                            {$_}
                        </div>
                    </div>
                </li>
            {/foreach}
    </ul>
{/if}
