(function(a){a.wa_blog.post={options:{redirect:"?"},init:function(d){this.options=a.extend(this.options,d);var c=this;a("#postdelete-dialog input[type=button]").click(function(a){return c.deleteHandler.apply(c,[this,a])});a("#blog-stream-primary-menu .b-search-form input.search").keydown(function(b){if(13==b.keyCode)return b=a(this).val(),location.search="?text="+encodeURIComponent(b),!1})},deleteHandler:function(d){var c=a(d).parents("form"),b=parseInt(c.find("input[name=id]").val()),e=parseInt(c.find("input[name=blog_id]").val());
b?(a(d).attr("disabled",!0).after('<i class="icon16 loading"></i>'),a.ajax({url:"?module=post&action=delete",data:{id:[b]},type:"post",dataType:"json",success:function(b){"ok"==b.status&&b.data.deleted?location.href=e?"?blog="+e:a.wa_blog.post.options.redirect:(a("#postdelete-dialog .icon16.loading").remove(),a("#postdelete-dialog input[type=button]:disabled").removeAttr("disabled"),a.wa_blog.dialogs.close("postdelete"))},error:function(){a("#postdelete-dialog .icon16.loading").remove();a("#postdelete-dialog input[type=button]:disabled").removeAttr("disabled");
a.wa_blog.dialogs.close("postdelete")}})):a.wa_blog.dialogs.close("postdelete")}}})(jQuery);
